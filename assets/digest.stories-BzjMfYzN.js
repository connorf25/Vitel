import"./index-BCAj_bCp.js";import{c as i,d as n,o as r,e as l,n as o,f as h,a as y,t as m}from"./vue.esm-bundler-CIUkA9VC.js";import{_ as u}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as g}from"./http-BXV5vmy8.js";import{V as b}from"./vitel-De4LWFz0.js";import{s as k}from"./entry-preview-BsfXFv1X.js";import"./_commonjsHelpers-C4iS2aBk.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./_baseSlice-BD4yksuF.js";import"./isObjectLike-Dipz0mOK.js";import"./isArray-Dxzbedgu.js";import"./isSymbol-C1qQj8zB.js";import"./isArrayLike-DYVE1Yub.js";import"./_isIterateeCall-B847D5xG.js";const f={data(){return{data:void 0,displayContent:"",displayClass:void 0,isLazy:!1,loading:!0,useLabel:!0}},props:{url:{type:[Object,String],required:!0},field:{type:String,default:"title"},filter:{type:[Function,String]},label:{type:String},lazy:{type:Boolean,default:!0},lazyParents:{type:String,default:"#content, #main, body"},lazyParentsDisable:{type:String,default:".modal"},classValid:{type:String},classInvalid:{type:String},textValid:{type:[String,Function]},textInvalid:{type:[String,Function]},iconValid:{type:String},iconInvalid:{type:String},ignoreErrors:{type:Boolean,default:!1},hashMethod:{type:String,defualt:"url+field",validator:e=>["url","url+field","request","custom"].includes(e)},hash:{type:String},httpWrapper:{type:String,default:"throttle"}},methods:{refresh(){if(this.loading=!0,this.useLabel&&this.label)this.displayContent=this.label,this.displayIcon=this.iconValid,this.loading=!1;else return this.$http[this.httpWrapper]({method:"GET",url:this.url,hashMethod:this.hashMethod}).then(({data:e})=>{if(this.field&&e[this.field]!==void 0)return e[this.field];if(this.field)console.trace(`Data from URL ${this.url} does not contain field "${this.field}"`,e);else return e}).then(e=>{if(this.data=e,this.displayContent=typeof this.textValid=="string"?this.textValid:typeof this.textValid=="function"?this.textValid(e):e,this.filter)if(_.isFunction(this.filter))this.displayContent=this.filter(this.displayContent);else if(_.isString(this.filter)){var t=this.$filters[this.filter];if(!t)throw new Error(`Unknown filter "${this.filter}" specified in <digest filter/>`);this.displayContent=t(this.displayContent)}else throw new Error("Unknown filter type specified in <digest filter/>");this.displayIcon=this.iconValid,this.classValid&&(this.displayClass=this.classValid)}).catch(e=>{this.displayContent=typeof this.textInvalid=="string"?this.textInvalid:typeof this.textInvalid=="function"?this.textInvalid(e):e.statusText?e.statusText:e,this.displayIcon=this.iconInvalid,this.classInvalid&&(this.displayClass=this.classInvalid),this.ignoreErrors||this.$toast.catch(e)}).finally(()=>this.loading=!1)}},mounted(){if(this.$el.closest(this.lazyParentsDisable)&&(this.isLazy=!1),this.isLazy){var e=new IntersectionObserver(()=>{this.refresh(),e.disconnect(),e=null},{root:this.$el.closest(this.lazyParents),rootMargin:"100px",threshold:.1});e.observe(this.$el)}else this.refresh()},watch:{url(){this.refresh()}}},v={class:"digest"};function I(e,t,C,x,s,S){return r(),i("div",v,[s.loading?n(e.$slots,"loading",{key:0,config:e.$props},()=>[t[0]||(t[0]=l("i",{class:"fas fa-spinner fa-spin"},null,-1))]):n(e.$slots,"display",{key:1,config:e.$props,data:s.data,displayContent:s.displayContent},()=>[l("div",{class:o(s.displayClass)},[e.displayIcon?(r(),i("i",{key:0,class:o(e.displayIcon)},null,2)):h("",!0),y(" "+m(s.displayContent),1)],2)])])}const V=u(f,[["render",I]]);f.__docgenInfo={exportName:"default",displayName:"digest",type:1,props:[{name:"lazy",global:!1,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]},default:"true"},{name:"field",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:'"title"'},{name:"lazyParents",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:'"#content, #main, body"'},{name:"lazyParentsDisable",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:'".modal"'},{name:"ignoreErrors",global:!1,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]},default:"false"},{name:"httpWrapper",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:'"throttle"'},{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[{name:"lazy",type:"boolean",description:"",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"field",type:"string",description:"",declarations:[],schema:"string"},{name:"lazyParents",type:"string",description:"",declarations:[],schema:"string"},{name:"lazyParentsDisable",type:"string",description:"",declarations:[],schema:"string"},{name:"ignoreErrors",type:"boolean",description:"",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"httpWrapper",type:"string",description:"",declarations:[],schema:"string"},{name:"data",type:"any",description:"",declarations:[],schema:"any"},{name:"displayContent",type:"string",description:"",declarations:[],schema:"string"},{name:"displayClass",type:"any",description:"",declarations:[],schema:"any"},{name:"isLazy",type:"boolean",description:"",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"loading",type:"boolean",description:"",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"useLabel",type:"boolean",description:"",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}}],sourceFiles:"/home/runner/work/Vitel/Vitel/components/digest.vue"};k(e=>{e.use(b),e.service("$http",g)});const W={title:"Components/Digest",component:V,tags:["autodocs"]},a={args:{url:"/api/users/count",field:"count",classValid:"badge rounded-pill bg-primary",iconValid:"fas fa-user",classInvalid:"badge rounded-pill bg-danger",iconInvalid:"fas fa-circle-xmark",textInvalid:"Error fetching users"}};var d,p,c;a.parameters={...a.parameters,docs:{...(d=a.parameters)==null?void 0:d.docs,source:{originalSource:`{
  args: {
    url: '/api/users/count',
    field: 'count',
    // Styling:
    classValid: 'badge rounded-pill bg-primary',
    iconValid: 'fas fa-user',
    classInvalid: 'badge rounded-pill bg-danger',
    iconInvalid: 'fas fa-circle-xmark',
    textInvalid: 'Error fetching users'
  }
}`,...(c=(p=a.parameters)==null?void 0:p.docs)==null?void 0:c.source}}};const O=["Example"];export{a as Example,O as __namedExportsOrder,W as default};
