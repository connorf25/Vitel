var F=Object.defineProperty;var B=(t,e,n)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var u=(t,e,n)=>(B(t,typeof e!="symbol"?e+"":e,n),n);import{o as d,c as p,j as P,e as o,t as y,f as q,T as A,d as $,I as T,n as C,J as m,b as h,m as c,a as k}from"./vue.esm-bundler-CIUkA9VC.js";import{_ as g}from"./_plugin-vue_export-helper-DlAUqK2U.js";class x{constructor(e){u(this,"max",0);u(this,"absolute",0);u(this,"float",0);u(this,"percent",0);if((e==null?void 0:e.max)===void 0)throw new Error("Position must have a `max` key");if(this.max=e.max,e.absolute!==void 0)this.absolute=e.absolute,this.float=e.absolute/this.max,this.percent=Math.round(this.float*100);else if(e.float!==void 0)this.absolute=this.max*e.float,this.float=e.float,this.percent=Math.round(this.float*100);else throw new Error("new Position object must be provided `max` + (`absolute` || `float`)");this.max>0&&this.absolute>this.max&&console.warn("Position.max",this.max,"is higher than maximum",this.max)}}const N={provide(){return{st:this}},data(){return{position:new x({max:0,absolute:0}),children:[],focusedItem:null,status:"manual",playing:!1,playTimer:null}},props:{startAt:{type:String},debug:{type:Boolean,default:!1},scrollRate:{type:Number,default:.5}},methods:{register(t){this.children.push(t)},setPlaying(t){if(this.playing=t,t){let e=performance.now(),n=r=>{let a=r-e;e=r;let i=this.position.absolute+a*this.scrollRate;i>=this.position.max?(console.log("End of play scope - pausing",{newAbsolute:i,max:this.position.max}),this.setPosition({absolute:this.position.max},{scrollTo:!0}),this.setPlaying(!1)):this.setPosition({absolute:i},{scrollTo:!0}),this.playing&&(this.playTimer=requestAnimationFrame(n))};this.playTimer=requestAnimationFrame(n)}else!t&&this.playTimer&&cancelAnimationFrame(this.playTimer)},setPosition(t,e){let n={scrollTo:!1,animateScrollTo:!1,pause:!1,...e},r=new x({max:this.position.max,...t});if(r.absolute==this.position.absolute&&r.max==this.position.max)return;this.position=r,n.scrollTo&&this.$el.scrollTo({top:this.position.absolute,behavior:n.animateScrollTo?"smooth":"instant"}),n.pause&&this.playing&&this.setPlaying(!1),this.$el.style.setProperty("--storytelling-position-offset",`${this.position.percent}s`),this.$el.style.setProperty("--storytelling-position-delay",`-${this.position.percent}s`);let a=Array.from(this.$el.querySelectorAll(".scrollytelling-item")),i=this.$el.getBoundingClientRect();if(this.focusedItem=a.map(s=>{let l=s.getBoundingClientRect(),f=Math.min(l.bottom,i.bottom)-Math.max(l.top,i.top);return{el:s,rect:l,exposure:f<=0?0:f/(l.bottom-l.top)*100}}).reduce((s,l)=>l.exposure>0&&(!s||l.exposure>s.exposure)?l:s,null),this.focusedItem){let s=this.focusedItem.el.$vueComponent;s.innerPosition=new x({max:s.lifetime,absolute:0-this.focusedItem.rect.top})}a.forEach(s=>s.classList.toggle("focused",s==this.focusedItem.el))},domScrollListener(){this.setPosition({max:this.$el.scrollHeight-this.$el.clientHeight,absolute:this.$el.scrollTop},{scrollTo:!1})}},mounted(){this.$el.addEventListener("scroll",this.domScrollListener,{passive:!0}),this.$nextTick().then(()=>this.setPosition({absolute:0,max:this.$el.scrollHeight-this.$el.clientHeight},{scrollTo:!1})).then(()=>this.$watch("startAt",t=>{if(!t)return;let e=document.querySelector(t);if(!e)throw new Error(`Cannot locate DOM element "${t}" to use it as a starting position`);e.scrollIntoView()},{immediate:!0}))}},M={class:"scrollytelling"},O={key:0,id:"scrollytelling-debug",class:"card"};function K(t,e,n,r,a,i){return d(),p("div",M,[(d(),P(A,{to:"body"},[n.debug?(d(),p("div",O,[o("table",null,[o("tr",null,[e[0]||(e[0]=o("td",null,"Focus:",-1)),o("td",null,y(a.focusedItem?a.focusedItem.el.id:"NONE"),1)]),e[5]||(e[5]=o("tr",null,[o("td",{colspan:"2"},[o("hr")])],-1)),o("tr",null,[e[1]||(e[1]=o("td",null,"Position (Float):",-1)),o("td",null,y(a.position.float),1)]),o("tr",null,[e[2]||(e[2]=o("td",null,"Position (%):",-1)),o("td",null,y(a.position.percent)+"%",1)]),o("tr",null,[e[3]||(e[3]=o("td",null,"Position (Abs):",-1)),o("td",null,y(a.position.absolute),1)]),o("tr",null,[e[4]||(e[4]=o("td",null,"Position (Max):",-1)),o("td",null,y(a.position.max),1)])])])):q("",!0)])),$(t.$slots,"default")])}const D=g(N,[["render",K]]);N.__docgenInfo={exportName:"default",displayName:"scrollytelling",type:1,props:[{name:"debug",global:!1,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]},default:"false"},{name:"scrollRate",global:!1,description:"",tags:[],required:!1,type:"number",declarations:[],schema:"number",default:"0.5"},{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"startAt",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"}],events:[],slots:[],exposed:[{name:"debug",type:"boolean",description:"",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"scrollRate",type:"number",description:"",declarations:[],schema:"number"},{name:"startAt",type:"string",description:"",declarations:[],schema:"string"},{name:"position",type:"{ max: number; absolute: number; float: number; percent: number; }",description:"The current stage position",declarations:[],schema:"{ max: number; absolute: number; float: number; percent: number; }"},{name:"children",type:"any[]",description:"Lookup collection for all <scrollytelling-item/> children",declarations:[],schema:{kind:"array",type:"any[]",schema:["any"]}},{name:"focusedItem",type:"any",description:"The calculated <scrollytelling-item/> with the most claim to being focused",declarations:[],schema:"any"},{name:"status",type:"string",description:`The state of the animation
ENUM: 'manual' Human needs to scroll to play, 'playing' Animation is auto-playing, 'restart' Board needs restarting`,declarations:[],schema:"string"},{name:"playing",type:"boolean",description:"Whether the stage is currently auto-playing",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"playTimer",type:"any",description:"Timer handle auto-scrolling (if `playing=true`)\nCreated by requestAnimationFrame() in a loop while auto-playing",declarations:[],schema:"any"}],sourceFiles:"/home/runner/work/Vitel/Vitel/components/scrollytelling.vue"};const R={inject:["st"],provide(){return{stItem:this}},data(){return{innerPosition:null,lifetime:0}},props:{position:{type:String,validate:t=>["screen","screen-snap","inline"].includes(t),default:"screen"},follow:{type:Boolean,default:!0}},methods:{setLifetime(t){this.lifetime=t}},mounted(){this.st.register(this),this.$el.$vueComponent=this}},L={class:"content"};function H(t,e,n,r,a,i){return d(),p("div",{class:C(["scrollytelling-item",[`position-${n.position}`,n.follow&&"follow"]])},[o("div",L,[$(t.$slots,"default")]),a.lifetime>0?(d(),p("div",{key:0,class:"lifetime-padding",style:T(`height: ${a.lifetime}px`)},null,4)):q("",!0)],2)}const U=g(R,[["render",H]]);R.__docgenInfo={exportName:"default",displayName:"scrollytelling-item",type:1,props:[{name:"position",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:'"screen"'},{name:"follow",global:!1,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]},default:"true"},{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[{name:"position",type:"string",description:"",declarations:[],schema:"string"},{name:"follow",type:"boolean",description:"",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"innerPosition",type:"any",description:"Position within this scrollytelling-item",declarations:[],schema:"any"},{name:"lifetime",type:"number",description:`Number of life units this component is expected to hang around
Calculated automatically by <scrollytelling-video/> etc.
Use setLifetime() to populate`,declarations:[],schema:"number"}],sourceFiles:"/home/runner/work/Vitel/Vitel/components/scrollytelling-item.vue"};const I={inject:["st"],props:{position:{type:String,validate:t=>["top","bottom","left","right"].includes(t),default:"bottom"}}};function j(t,e,n,r,a,i){return d(),p("div",{class:C(["scrollytelling-timeline",[`position-${n.position}`]])},[o("div",{class:"position-indicator",style:T(`${n.position=="top"||n.position=="bottom"?"width":"height"}: ${i.st.position}%`)},null,4)],2)}const z=g(I,[["render",j]]);I.__docgenInfo={exportName:"default",displayName:"scrollytelling-timeline",type:1,props:[{name:"position",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:'"bottom"'},{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[{name:"position",type:"string",description:"",declarations:[],schema:"string"}],sourceFiles:"/home/runner/work/Vitel/Vitel/components/scrollytelling-timeline.vue"};const V={inject:["stItem"],data(){return{stopPosition:null}},props:{syncMethod:{type:String,validate:t=>["setPosition","playForward"].includes(t),default:"playForward"},url:{type:String,required:!0}},methods:{domDurationChange(t){this.stItem.setLifetime(Math.ceil(t.target.duration*1e3))},domTimeUpdate(t){t.target.currentTime>=this.stopPosition&&this.$refs.videoEl.pause()}},mounted(){this.$watch("stItem.innerPosition.absolute",(t,e)=>{if(this.syncMethod=="playForward"&&e!=null&&t>e)this.stopPosition=t/1e3,this.$refs.videoEl.play();else{let n=t/1e3;this.$refs.videoEl.currentTime=n}},{immediate:!0})}},W=["src"];function J(t,e,n,r,a,i){return d(),p("div",null,[o("video",{ref:"videoEl",controlslist:"nodownload nofullscreen noremoteplayback",disablepictureinpicture:"",disableremoteplayback:"",muted:"",preload:"auto",src:n.url,onDurationchange:e[0]||(e[0]=(...s)=>i.domDurationChange&&i.domDurationChange(...s)),onTimeupdate:e[1]||(e[1]=(...s)=>i.domTimeUpdate&&i.domTimeUpdate(...s))},null,40,W)])}const G=g(V,[["render",J]]);V.__docgenInfo={exportName:"default",displayName:"scrollytelling-video",type:1,props:[{name:"syncMethod",global:!1,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string",default:'"playForward"'},{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[{name:"syncMethod",type:"string",description:"",declarations:[],schema:"string"},{name:"stopPosition",type:"any",description:"Optional position to pause at in seconds\nUsed in the `playForward` sync method to stop the video when it reaches this position",declarations:[],schema:"any"}],sourceFiles:"/home/runner/work/Vitel/Vitel/components/scrollytelling-video.vue"};const S={components:{Scrollytelling:D,ScrollytellingItem:U,ScrollytellingTimeline:z,ScrollytellingVideo:G}};function Q(t,e,n,r,a,i){const s=h("scrollytelling-item"),l=h("scrollytelling-video"),f=h("scrollytelling-timeline"),E=h("scrollytelling");return d(),P(E,{"start-at":"#slide-4"},{default:m(()=>[c(s,{id:"slide-1",position:"screen",class:"bg-text bg-white"},{default:m(()=>e[0]||(e[0]=[k(" Slide 1 ")])),_:1}),c(s,{id:"slide-2",position:"screen",class:"bg-text bg-blue"},{default:m(()=>e[1]||(e[1]=[k(" Slide 2 ")])),_:1}),c(s,{id:"slide-3",position:"screen",class:"bg-text bg-yellow"},{default:m(()=>e[2]||(e[2]=[k(" Slide 3 ")])),_:1}),c(s,{id:"slide-4",position:"screen"},{default:m(()=>[c(l,{url:"https://storage.googleapis.com/dara-c1b52.appspot.com/daras_ai/media/ea6bd022-a62b-11ed-b0a8-02420a0001c9/gooey.ai%20text%20to%20animation%20-%200%20a%20lush%20garden%20in%20...remely%20detailed%20face%20full%20body%203d%20realism%20render.mp4"})]),_:1}),c(s,{id:"slide-5",position:"screen"},{default:m(()=>[c(l,{url:"https://storage.googleapis.com/dara-c1b52.appspot.com/daras_ai/media/cc19bb48-bd82-11ed-a0b0-02420a000113/gooey.ai%20animation%20%5Bframe%200%20prompt%20a%20wide%20angle%20...oto%20of%20a%20busy%20street%20in%20Warsaw%20Poland%204k%208k%20UHD%5D.mp4"})]),_:1}),c(f,{position:"bottom"})]),_:1})}const X=g(S,[["render",Q]]);S.__docgenInfo={exportName:"default",displayName:"scrollytelling.demo",type:1,props:[{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[],sourceFiles:"/home/runner/work/Vitel/Vitel/components/scrollytelling.demo.vue"};const te={title:"Components/ScrollyTelling",component:X,tags:["autodocs"],argTypes:{}},b={};var w,_,v;b.parameters={...b.parameters,docs:{...(w=b.parameters)==null?void 0:w.docs,source:{originalSource:"{}",...(v=(_=b.parameters)==null?void 0:_.docs)==null?void 0:v.source}}};const ne=["Example"];export{b as Example,ne as __namedExportsOrder,te as default};
