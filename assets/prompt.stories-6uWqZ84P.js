import"./index-BCAj_bCp.js";import{P as N}from"./placeholder-jeHkrtFt.js";import{s as f}from"./startCase-D0NCxCvp.js";import{V}from"./vitel-De4LWFz0.js";import{D as O}from"./dynamic-CVOJuCPU.js";import{b as C,o as r,c as a,j as g,F as k,D as v,e as l,n as m,a as b,t as h,f as p,T as x,m as B}from"./vue.esm-bundler-CIUkA9VC.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as I}from"./entry-preview-BsfXFv1X.js";import"./_createCompounder-DTfH5kOa.js";import"./_baseSlice-BD4yksuF.js";import"./isObjectLike-Dipz0mOK.js";import"./isArray-Dxzbedgu.js";import"./isSymbol-C1qQj8zB.js";import"./isArrayLike-DYVE1Yub.js";const E={name:"$prompt",data(){return{stack:[],handler:null}},computed:{active(){return this.stack.at(-1)},isOpen(){return this.stack.length>0}},methods:{dialog(e){var i;let t=this,n={id:null,title:"Question",body:"",isHtml:!1,modalClass:"",modalDialogClass:"",component:null,componentProps:{},closable:!0,closeButton:!0,keyboard:!0,backdrop:!0,dialogClose:"reject",buttons:null,stack:!1,modelEl:null,modelBS:null,autoListen:"change",payloadResolve:void 0,payloadReject:void 0,promise:null,promiseResolve:null,promiseReject:null,...e};return n.closable||Object.assign(n,{closeButton:!1,keyboard:!1}),n.buttons&&(n.buttons=n.buttons.map(s=>typeof s=="object"?s:["accept","close","confirm","ok","save"].includes(s)?{click:"resolve",class:"btn btn-success",icon:"fas fa-check",title:f(s)}:["cancel"].includes(s)?{click:"reject",class:"btn btn-danger",icon:"fas fa-times",title:f(s)}:["back"].includes(s)?{click:"reject",class:"btn btn-light",icon:"fas fa-arrow-left",title:f(s)}:["-"].includes(s)?{class:"d-block flex-grow-1",title:""}:(()=>{throw new Error(`Unknown button shorthand "${s}"`)})())),n.autoListen&&n.component&&!((i=n.componentEvents)!=null&&i.change)&&(this.debug(`Enabling @${n.autoListen} event listener for $prompt component`),n.componentEvents={[n.autoListen](s){s&&s instanceof Event||(t.debug(`Set resolve payload from @${n.autoListen}`,{payload:s}),n.payloadResolve=s)},...n.componentEvents}),Promise.resolve().then(()=>{if(!n.stack)return this.debug(".dialog()","Closing all dialogs due to no-stacking option"),[...this.stack].reverse().reduce((s,d)=>(this.dialog("Close (no-stacking)",d.id),this.close(!1,"CLOSE-NOSTACKING")),Promise.resolve())}).then(()=>this.handler.push(n)).then(()=>n.promise=new Promise((s,d)=>{n.promiseResolve=s,n.promiseReject=d}))},close(e=!0,t){var n,i;return t===void 0&&((n=this.active)==null?void 0:n[e?"payloadResolve":"payloadReject"])!==void 0&&(t=(i=this.active)==null?void 0:i[e?"payloadResolve":"payloadReject"]),this.debug(".close()",{success:e,payload:t}),this.handler.pop(e,t)},closeIfOpen(e=!1,t){return this.isOpen?(this.debug(".closeIfOpen()",{success:e,payload:t}),this.handler.pop(e,t).then(()=>!0)):!1}},created(){}};E.__docgenInfo={exportName:"default",displayName:"prompt",type:1,props:[{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[{name:"stack",type:"any[]",description:"Current prompt stack if displaying multiple prompts",declarations:[],schema:{kind:"array",type:"any[]",schema:["any"]}},{name:"handler",type:"any",description:"<prompt-handler/> VueComponent when it has registered itself",declarations:[],schema:"any"},{name:"active",type:"any",description:"The currently active prompt settings (if any)\nTaken as the last item in `stack`",declarations:[],schema:"any"},{name:"isOpen",type:"boolean",description:"Indicator that a modal is open",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}}],sourceFiles:"/home/runner/work/Vitel/Vitel/services/prompt.vue"};const R={components:{Dynamic:O},methods:{async push(e){return e.id||(e.id=`prompt-${Date.now()}`),console.info("$prompt.push",e),this.$prompt.stack.push(e),await this.$nextTick(),e.modelEl=document.body.querySelector(`#prompt-handler #${e.id}`),e.modelEl.addEventListener("hidden.bs.modal",()=>this.$prompt.close(e.dialogClose=="resolve")),e.modelBS=new window.bootstrap.Modal(e.modelEl,{backdrop:e.backdrop,keyboard:e.keyboard,focus:!0}),new Promise(t=>{e.modelEl.addEventListener("shown.bs.modal",()=>t()),e.modelBS.show()})},pop(e=!0,t){let n=this.$prompt.stack.pop();if(n)return n.modelBS.hide(),e?n.promiseResolve(t):n.promiseReject(t)},triggerButton(e){if(e!=null&&e.click){if(e.click=="resolve")return this.$prompt.close(!0);if(e.click=="reject")return this.$prompt.close(!1);if(typeof e.click=="function"){let t=this.$refs.dynamicOuter[0].$refs.dynamicInner;return Promise.resolve(e.click.call(t,t,e))}else throw new Error("No click handler set up on button")}else throw new Error("Invalid button spec")}},created(){if(!this.$prompt)throw new Error("$prompt service not found - check the service has been installed correctly");let e=document.createElement("div");e.id="prompt-handler",document.body.appendChild(e),this.$prompt.handler=this}},j=["id","aria-labelledby"],H=["id"],L=["onClick"],S={class:"modal-body"},T=["innerHTML"],D=["textContent"],K={key:1,class:"modal-footer d-flex d-justify-end"},F=["onClick"];function W(e,t,n,i,s,d){const y=C("dynamic");return r(),a("div",null,[(r(),g(x,{to:"#prompt-handler"},[(r(!0),a(k,null,v(e.$prompt.stack,o=>(r(),a("div",{key:o.id,class:"modal fade",id:o.id,tabindex:"-1","aria-labelledby":`${o.id}-header`,"aria-hidden":"true"},[l("div",{class:m(["modal-dialog",o.modalDialogClass])},[l("div",{class:m(["modal-content",o.modalClass])},[o.title?(r(),a("div",{key:0,id:`${o.id}-header`,class:"modal-header"},[b(h(o.title)+" ",1),e.$prompt.closeButton?(r(),a("a",{key:0,onClick:c=>e.$prompt.close(o.dialogClose=="resolve"),class:"btn btn-link btn-close","aria-label":"Close"},t[0]||(t[0]=[l("i",{class:"fas fa-lg fa-times"},null,-1)]),8,L)):p("",!0)],8,H)):p("",!0),l("div",S,[o.isHtml?(r(),a("div",{key:0,innerHTML:o.body},null,8,T)):(r(),a("div",{key:1,textContent:h(o.body)},null,8,D)),o.component?(r(),g(y,{key:2,ref_for:!0,ref:"dynamicOuter","ref-handle":"dynamicInner",component:o.component,props:o.componentProps,events:o.componentEvents},null,8,["component","props","events"])):p("",!0)]),o.buttons&&o.buttons.length>0?(r(),a("div",K,[(r(!0),a(k,null,v(o.buttons,c=>(r(),a("a",{key:c,onClick:J=>d.triggerButton(c),class:m(c.class||"btn btn-light")},[c.icon?(r(),a("i",{key:0,class:m(c.icon)},null,2)):p("",!0),b(" "+h(c.title),1)],10,F))),128))])):p("",!0)],2)],2)],8,j))),128))]))])}const A=P(R,[["render",W]]);R.__docgenInfo={exportName:"default",displayName:"prompt-handler",type:1,props:[{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[],sourceFiles:"/home/runner/work/Vitel/Vitel/services/prompt-handler.vue"};const q={components:{PromptHandler:A}},M={class:"card mb-2"},U={class:"card-body"},z={class:"list-group"};function G(e,t,n,i,s,d){const y=C("prompt-handler");return r(),a("div",null,[B(y),l("div",M,[t[4]||(t[4]=l("div",{class:"card-header"},"Prompts",-1)),l("div",U,[t[3]||(t[3]=l("p",null,"Popup and other UI locking window functionality for simple input prompts",-1)),l("div",z,[l("a",{onClick:t[0]||(t[0]=o=>e.$prompt.dialog({body:"Hello World"})),class:"list-group-item list-group-item-action"}," $prompt.dialog({body: 'Hello World'}) "),l("a",{onClick:t[1]||(t[1]=o=>e.$prompt.dialog({body:"<strong>Hello</strong> World",isHtml:!0,buttons:["cancel","ok"]})),class:"list-group-item list-group-item-action"}," $prompt.dialog({body: '<strong>Hello</strong> World', isHtml: true, buttons: ['cancel', 'ok']}) "),l("a",{onClick:t[2]||(t[2]=o=>e.$prompt.dialog({component:"placeholder",componentProps:{text:"A model!"}})),class:"list-group-item list-group-item-action"}," $prompt.dialog({component: 'placeholder', componentProps: {text: 'A model!'}}) ")])])])])}const Q=P(q,[["render",G]]);q.__docgenInfo={exportName:"default",displayName:"prompt.demo",type:1,props:[{name:"key",global:!0,description:"",tags:[],required:!1,type:"PropertyKey",declarations:[],schema:{kind:"enum",type:"PropertyKey",schema:["string","number","symbol"]}},{name:"ref",global:!0,description:"",tags:[],required:!1,type:"VNodeRef",declarations:[],schema:{kind:"enum",type:"VNodeRef",schema:["string","Ref<any, any>",{kind:"event",type:"(ref: Element | ComponentPublicInstance<{}, {}, {}, {}, {}, {}, {}, {}, false, ComponentOptionsBase<any, any, any, any, any, any, any, any, any, {}, {}, string, {}, {}, {}, string, ComponentProvideOptions>, ... 4 more ..., any>, refs: Record<...>): void",schema:[]}]}},{name:"ref_for",global:!0,description:"",tags:[],required:!1,type:"boolean",declarations:[],schema:{kind:"enum",type:"boolean",schema:["false","true"]}},{name:"ref_key",global:!0,description:"",tags:[],required:!1,type:"string",declarations:[],schema:"string"},{name:"class",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"},{name:"style",global:!0,description:"",tags:[],required:!1,type:"unknown",declarations:[],schema:"unknown"}],events:[],slots:[],exposed:[],sourceFiles:"/home/runner/work/Vitel/Vitel/services/prompt.demo.vue"};I(e=>{e.use(V),e.component("Placeholder",N),e.service("$prompt",E)});const pe={title:"Services/Prompt",component:Q,tags:["autodocs"],argTypes:{}},u={};var $,_,w;u.parameters={...u.parameters,docs:{...($=u.parameters)==null?void 0:$.docs,source:{originalSource:"{}",...(w=(_=u.parameters)==null?void 0:_.docs)==null?void 0:w.source}}};const me=["Example"];export{u as Example,me as __namedExportsOrder,pe as default};
